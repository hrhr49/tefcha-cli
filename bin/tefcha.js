(function () {var Y={};var Z={};var K={},ya=K&&K.__extends||function(){var e=function(r,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])})(r,n)};return function(r,n){function t(){this.constructor=r}e(r,n),r.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}(),ia=K&&K.__assign||function(){return(ia=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)},V=K&&K.__spreadArrays||function(){for(var e=0,r=0,n=arguments.length;r<n;r++)e+=arguments[r].length;var t=Array(e),o=0;for(r=0;r<n;r++)for(var a=arguments[r],s=0,i=a.length;s<i;s++,o++)t[o]=a[s];return t},B=function(e){function r(r){var n=r.lineno,t=r.msg,o=r.src,a=void 0===o?"":o,s=t;n&&n>0&&(s="at line "+n+": "+s);var i="";return a&&n>0&&(i=a.split(/\n/).map(function(e,r){return{lineno:r+1,line:e}}).slice(Math.max(0,n-1-5),n-1+5).map(function(e){var r=e.lineno,t=e.line;return(r===n?">":" ")+r+": "+t}).join("\n")),e.call(this,s+"\n"+i)||this}return ya(r,e),r}(Error),ja=["if","else","elif","while","for","do","switch","case","try","except"],ka=V(ja,["continue","break","pass"]),a=V(ka,["program","none","text"]),za=function(e){return ja.includes(e)},Aa=function(e){return ka.includes(e)},Ba=function(e,r){var n=[],t="",o=r.src,a=o.indentStr,s=o.commentStr;if(e.split(/\r\n|\r|\n/).forEach(function(e,r){if(r++,""!==(e=t+e).trim()){for(var o=0;e.startsWith(a);)o++,e=e.slice(a.length);e.startsWith(s)||(e.endsWith("\\")?t=e.slice(0,-1):(t="",n.push({lineno:r,line:e,nest:o})))}}),""!==t)throw new B({msg:"EOF is found after '\\'"});var i=Math.min.apply(Math,n.map(function(e){return e.nest}));return n=n.map(function(e){return ia(ia({},e),{nest:e.nest-i})})},Ca=function(e,r){var n={type:"program",lineno:0,children:[]},t=[n];return e.forEach(function(e){var n=e.lineno,o=e.line,a=e.nest;if(t.length-1<a)throw new B({lineno:n,src:r,msg:"unexpected indent"});for(;t.length-1>a;)t.pop();var s=t.slice(-1)[0],i=o.split(" ")[0];if(Aa(i)){var $={type:i,lineno:n,content:o.slice(o.indexOf(" ")+1),children:[]},c=s.children.length>0?s.children.slice(-1)[0]:null;s.children.push($),za(i)&&(c&&"do"===c.type&&"while"===i||t.push($))}else s.children.push({type:"text",lineno:n,content:o})}),n},la=function(e,r,n){var t=e.children||[],o={type:"none",lineno:-1};t.forEach(function(a,s){var i=a.lineno;switch(a.type){case"program":break;case"none":throw new B({lineno:i,src:n,msg:"node type \""+a.type+"\" must not be here... this may be bug"});case"text":case"if":break;case"else":if(!["if","elif"].includes(o.type))throw new B({lineno:i,src:n,msg:"before \"else\" statement, \"if\" or \"elif\" should exists."});break;case"elif":if(!["if","elif"].includes(o.type))throw new B({lineno:i,src:n,msg:"before \"elif\" statement, \"if\" or \"elif\" should exists."});break;case"while":break;case"for":case"switch":case"case":throw new B({lineno:i,src:n,msg:"node type \""+a.type+"\" is not implemented yet."});case"continue":if(!V(r,[e]).some(function(e){return["for","while","do"].includes(e.type)}))throw new B({lineno:i,src:n,msg:"\"continue\" statement should be in loop"});break;case"break":if(!V(r,[e]).some(function(e){return["for","while","do","case"].includes(e.type)}))throw new B({lineno:i,src:n,msg:"\"break\" statement should be in loop or \"case\"."});break;case"do":if(s+1>=t.length||"while"!==t[s+1].type)throw new B({lineno:i,src:n,msg:"cannot find corresponding keyword \"while\" to keyword \"do\"."});break;case"pass":break;case"try":if(s+1>=t.length||"except"!==t[s+1].type)throw new B({lineno:i,src:n,msg:"cannot find corresponding keyword \"except\" to keyword \"try\"."});break;case"except":if(!["try","except"].includes(o.type))throw new B({lineno:i,src:n,msg:"before \"except\" block, \"try\" or \"except\" block should exists."});break;default:var $=a.type;throw new B({lineno:i,src:n,msg:"node type \""+$+"\" is invalid."});}o=a}),"switch"===e.type&&t.forEach(function(e){var r=e.lineno;if("case"!==e.type)throw new B({lineno:r,src:n,msg:e.type+"\" is found in \"switch\" block. \"switch\" should have \"case\" only"})}),t.forEach(function(t){return la(t,V(r,[e]),n)})},ma=function(e,r){var n=Ba(e,r),t=Ca(n,e);return la(t,[],e),t};K.TefchaError=B,K.parse=ma;var P={};var G={},M=G&&G.__extends||function(){var t=function(r,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var n in r)r.hasOwnProperty(n)&&(t[n]=r[n])})(r,n)};return function(r,n){function $(){this.constructor=r}t(r,n),r.prototype=null===n?Object.create(n):($.prototype=n.prototype,new $)}}(),Da=G&&G.__spreadArrays||function(){for(var t=0,r=0,n=arguments.length;r<n;r++)t+=arguments[r].length;var $=Array(t),e=0;for(r=0;r<n;r++)for(var s=arguments[r],a=0,o=s.length;a<o;a++,e++)$[e]=s[a];return $},Q=Math.max,R=Math.min,L=function(){return function(t){var r=this,n=t.x,$=void 0===n?0:n,e=t.y,s=void 0===e?0:e,a=t.w,o=void 0===a?0:a,i=t.h,u=void 0===i?0:i,x=t.minX,p=void 0===x?0:x,m=t.minY,h=void 0===m?0:m,v=t.maxX,c=void 0===v?0:v,C=t.maxY,d=void 0===C?0:C;this.trans=function(t,n){return r.x+=t,r.y+=n,r},this.x=$,this.y=s,this.w=o,this.h=u,this.minX=p,this.minY=h,this.maxX=c,this.maxY=d}}(),U=function(t){function r(n){var $=n.x,e=n.y,s=t.call(this,{x:$,y:e})||this;return s.clone=function(){return new r({x:s.x,y:s.y})},s.type="point",s}return M(r,t),r}(L),H=function(t){function r(r){var n=r.x,$=r.y,e=r.cmds,s=r.isArrow,a=void 0!==s&&s,o=this,i=0,u=0,x=0,p=0,m=0,h=0;return e.forEach(function(t){var r=t[0],n=t[1];"h"===r?i+=n:u+=n,x=R(x,i),p=R(p,u),m=Q(m,i),h=Q(h,u)}),(o=t.call(this,{x:n,y:$,minX:x,minY:p,maxX:m,maxY:h,w:m-x,h:h-p})||this).cmds=e,o.isArrow=a,o.type="path",o}return M(r,t),r.vline=function(t){var n=t.x,$=t.y,e=t.step,s=t.isArrow;return new r({x:n,y:$,cmds:[["v",e]],isArrow:void 0!==s&&s})},r.hline=function(t){var n=t.x,$=t.y,e=t.step,s=t.isArrow;return new r({x:n,y:$,cmds:[["h",e]],isArrow:void 0!==s&&s})},r}(L),na=function(t){function r(r){var n=r.content,$=r.w,e=r.h,s=r.x,a=void 0===s?0:s,o=r.y,i=void 0===o?0:o,u=r.isLabel,x=void 0!==u&&u,p=t.call(this,{x:a,y:i,maxX:$,maxY:e,w:$,h:e})||this;return p.content=n,p.type="text",p.isLabel=x,p}return M(r,t),r.byMeas=function(t){var n=t.x,$=void 0===n?0:n,e=t.y,s=void 0===e?0:e,a=t.text,o=t.attrs,i=t.meas,u=t.isLabel,x=i(a,o);return new r({content:a,x:$,y:s,w:x.w,h:x.h,isLabel:u})},r}(L),oa=function(t){function r(r){var n=r.x,$=void 0===n?0:n,e=r.y,s=void 0===e?0:e,a=r.w,o=r.h,i=t.call(this,{x:$,y:s,w:a,h:o,maxX:a,maxY:o})||this;return i.type="rect",i}return M(r,t),r}(L),pa=function(t){function r(r){var n=r.x,$=void 0===n?0:n,e=r.y,s=void 0===e?0:e,a=r.w,o=r.h,i=t.call(this,{x:$,y:s,w:a,h:o,maxX:a,maxY:o})||this;return i.type="frame",i}return M(r,t),r}(L),qa=function(t){function r(r){var n=r.x,$=void 0===n?0:n,e=r.y,s=void 0===e?0:e,a=r.w,o=r.h,i=t.call(this,{x:$,y:s,w:a,h:o,maxX:a,maxY:o})||this;return i.type="diamond",i}return M(r,t),r}(L),aa=function(t){function r(r){var n=r.x,$=r.y,e=r.children,s=t.call(this,{x:n,y:$})||this;return s.add=function(t){return s.minX=R(s.minX,t.x+t.minX),s.minY=R(s.minY,t.y+t.minY),s.maxX=Q(s.maxX,t.x+t.maxX),s.maxY=Q(s.maxY,t.y+t.maxY),s.w=s.maxX-s.minX,s.h=s.maxY-s.minY,s.children.push(t),s},0===e.length&&(e=Da(e,[new U({x:n,y:$})])),s.minX=R.apply(void 0,e.map(function(t){return t.x+t.minX})),s.minY=R.apply(void 0,e.map(function(t){return t.y+t.minY})),s.maxX=Q.apply(void 0,e.map(function(t){return t.x+t.maxX})),s.maxY=Q.apply(void 0,e.map(function(t){return t.y+t.maxY})),s.w=s.maxX-s.minX,s.h=s.maxY-s.minY,s.type="group",s.children=e,s}return M(r,t),r}(L);G.BaseShape=L,G.Group=aa,G.Diamond=qa,G.Frame=pa,G.Rect=oa,G.Text=na,G.Path=H,G.Point=U;var ba=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n={start:-1/0,end:-1/0,next:null},r=n;t.forEach(function(t){var e={start:t[0],end:t[1],next:null};r.next=e,r=e});var a={start:1/0,end:1/0,next:null};return r.next=a,n},ea=function(){return function t(e){var n=this;this.clone=function(){return new t(n.ref)},this.cloneDeep=function(){return new t(ba.apply(void 0,n.ranges().map(function(t){return[t.start,t.end]})))},this.findSpace=function(t,e){for(var r=n.ref;r.next.start<t;)r=r.next;for(var a=Math.max(t,r.end);r.next.start-a<e;)a=(r=r.next).end;return n.ref=r,a},this.allocate=function(t,e){var r=n.findSpace(t,e),a=r+e,o=n.ref;if(o.end===r)o.next.start===a?(o.end=o.next.end,o.next=o.next.next):o.end=a;else if(o.next.start===a)o.next.start=r,n.ref=o.next;else{var x={start:r,end:a,next:o.next};o.next=x,n.ref=x}return r},this.merge=function(t,e){var r=t+e;t=Math.max(t,n.ref.start);for(var a,o=n.ref;o.next.start<=t;)o=o.next;for(t<=o.end?a=o:(a={start:t,end:t,next:o.next},o.next=a,o=a);o.next.start<=r;)o=o.next;r<=o.end?(a.end=o.end,a.next=o.next):(a.end=r,a.next=o.next),n.ref=a},this.ranges=function(){var t=[],e=n.ref;for(e.start===-1/0&&(e=e.next);e.start!==1/0;)t.push({start:e.start,end:e.end}),e=e.next;return t},this.mergeAllocator=function(t){t.ranges().forEach(function(t){var e=t.start,r=t.end;n.merge(e,r-e)})},this.ref=e}}();var ra=P&&P.__assign||function(){return(ra=Object.assign||function(e){for(var r,t=1,a=arguments.length;t<a;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)},N=P&&P.__spreadArrays||function(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var a=Array(e),o=0;for(r=0;r<t;r++)for(var n=arguments[r],i=0,s=n.length;i<s;i++,o++)a[o]=n[i];return a},fa={while:{break:"E",continue:"W"},doWhile:{break:"E",continue:"E"},for:{break:"E",continue:"W"}},ga=function(){return function(e){void 0===e&&(e="none"),this.type=e,this.breaks=[],this.continues=[]}}(),sa=function(){return function e(r){var t=this,a=r.shapes,o=r.measureText,n=r.config,i=r.loop,s=r.AllocW,c=r.AllocE,l=r.x,h=r.y;this.shiftX=function(e){var r=t,a=r.shapes,o=r.loop;a.trans(e,0),t.x+=e;var n=o.breaks,i=o.continues;n.forEach(function(r){return r.trans(e,0)}),i.forEach(function(r){return r.trans(e,0)})},this.step=function(e,r){void 0===e&&(e=t.dy),void 0===r&&(r=!1),t.shapes.add(H.vline({x:0,y:t.y,step:e,isArrow:r})),t.move(e)},this.stepAbs=function(e,r){void 0===r&&(r=!1),t.step(e-t.y,r)},this.move=function(e){void 0===e&&(e=t.dy),t.y+=e},this.moveAbs=function(e){t.move(e-t.y)},this.rect=function(e){var r=e.x,a=e.y,o=e.text,n=t.measureText(o,t.config.text.attrs),i=n.w,s=n.h,c=t.config.rect,l=i+2*c.padX,h=s+2*c.padY;return t.wrapText({cls:oa,text:o,x:r,y:a,w:l,h:h,tw:i,th:s})},this.diamond=function(e){var r=e.x,a=e.y,o=e.text,n=t.measureText(o,t.config.text.attrs),i=n.w,s=n.h,c=t.config.diamond.aspectRatio,l=i+s/c,h=s+i*c;return t.wrapText({cls:qa,text:o,x:r,y:a,w:l,h:h,tw:i,th:s})},this.wrapText=function(e){var r=e.cls,a=e.text,o=e.x,n=e.y,i=e.w,s=e.h,c=e.tw,l=e.th,h=t.text({text:a,x:-c/2,y:s/2-l/2,isLabel:!1}),p=new r({x:-i/2,w:i,h:s});return new aa({x:o,y:n,children:[h,p]})},this.text=function(e){var r=e.x,a=e.y,o=e.text,n=e.isLabel;return na.byMeas({x:r,y:a,text:o,attrs:t.config.text.attrs,meas:t.measureText,isLabel:n})},this.stepText=function(e){var r=t,a=r.dy,o=r.hlineMargin,n=t.rect({x:0,y:0,text:e}),i=t.AllocE.findSpace(t.y+a-o,n.h+o);t.AllocW.merge(i,n.h+o),t.stepAbs(i+o,!0),n.trans(0,t.y),t.shapes.add(n),t.move(n.h)},this.stepCond=function(e){var r,a=e.content,o=e.yesDir,n=e.noDir,i=e.jumpW,s=e.jumpE,c=e.stepY,l=void 0===c?t.dy:c,h=t,p=h.AllocW,$=h.AllocE,w=h.shapes,u=h.diamond,y=h.text,x=h.stepAbs,f=h.move,m=h.hlineMargin,v=t.config.label,d=v.yesText,T=v.noText,D=t.config.label,g=D.marginX,A=D.marginY,b=u({x:0,y:0,text:a});if(i)for(var E=t.y+l-m;;){var W=$.findSpace(E,b.h+m),S=p.findSpace(W+b.h/2,m);if(S===W+b.h/2){r=W;break}E=S-b.h/2}else r=$.findSpace(t.y+l-m,b.h+m);p.merge(r,b.h+m),s&&$.merge(r+b.h/2,m),x(r+m,!0),b.trans(0,t.y),w.add(b),f(b.h);var _={E:{x:b.w/2,y:b.y+b.h/2},W:{x:-b.w/2,y:b.y+b.h/2},S:{x:0,y:b.y+b.h}},j=t.measureText(d,t.config.label.attrs),F="W"!==o?_[o].x+g:_[o].x-g-j.w;w.add(y({x:F,y:_[o].y+A,text:d,isLabel:!0}));var X=t.measureText(T,t.config.label.attrs),k="W"!==n?_[n].x+g:_[n].x-g-X.w;return w.add(y({x:k,y:_[n].y+A,text:T,isLabel:!0})),_},this.branch=function(){return new e({shapes:new aa({x:t.x,y:t.y,children:[]}),measureText:t.measureText,config:t.config,loop:new ga(t.loop.type),AllocW:t.AllocW.clone(),AllocE:t.AllocE.clone(),x:t.x,y:t.y})},this.merge=function(e){var r,a;if(Object.is(t,e))throw"cannot merge same flowchart";e.shapes.children.forEach(function(r){r.trans(e.shapes.x,0),t.shapes.add(r)}),(r=t.loop.breaks).push.apply(r,e.loop.breaks),(a=t.loop.continues).push.apply(a,e.loop.continues),e.y>t.y&&t.moveAbs(e.y)},this.withLoop=function(e,r){var a=t,o=a.loop,n=a.AllocW,i=a.AllocE;t.loop=new ga(e);var s=new ea(ba()),c=i.cloneDeep(),l=s.clone(),h=c.clone();t.AllocW=s,t.AllocE=c,r();var p=t.loop;return t.loop=o,t.AllocW=n,t.AllocE=i,t.AllocW.mergeAllocator(l),t.AllocW.mergeAllocator(h),p},this.h=function(e){t.shapes.add(H.hline({x:0,y:e,step:100}))},this.type="flowchart",this.shapes=a,this.measureText=o,this.config=n,this.loop=i,this.AllocW=s,this.AllocE=c,this.alive=!0,this.dy=n.flowchart.stepY,this.dx=n.flowchart.stepX,this.hlineMargin=n.flowchart.hlineMargin,this.x=l,this.y=h}}(),ta=function(e){var r=e.node,t=e.config,a=e.measureText,o=new sa({shapes:new aa({x:0,y:0,children:[]}),measureText:a,config:t,loop:new ga,AllocW:new ea(ba()),AllocE:new ea(ba()),x:0,y:t.flowchart.marginY});return O(r,o),o.shiftX(-o.shapes.minX+t.flowchart.marginX),o},O=function(e,r,t){void 0===t&&(t=!1);for(var a=r.step,o=r.stepAbs,n=r.stepText,i=r.AllocW,s=r.AllocE,c=r.loop,l=r.hlineMargin,h=e.children,p=h.length,$=0;$<p&&r.alive;){var w=h[$];switch(w.type){case"text":n(w.content);break;case"pass":a();break;case"if":var u=[];for($<p&&"if"===h[$].type&&(u.push(h[$]),$++);$<p&&"elif"===h[$].type;)u.push(h[$]),$++;$<p&&"else"===h[$].type&&(u.push(h[$]),$++),ua(u,r);continue;case"while":Ea(w,r);break;case"do":Fa(w,h[$+1],r),$+=2;continue;case"break":case"continue":var y=fa[c.type][w.type],x=t?r.y-l:("W"===y?i:s).findSpace(r.y,l);i.merge(x,l),"E"===y&&s.merge(x,l),t||o(x+l);var f=c.breaks,m=c.continues;("break"===w.type?f:m).push(new U({x:0,y:r.y})),r.alive=!1;break;case"try":var v=w,d=[];for($++;$<p&&"except"===h[$].type;)d.push(h[$]),$++;Ga(v,d,r);continue;case"program":case"none":case"else":case"elif":case"for":case"switch":case"case":case"except":throw"child type "+w.type+" is not expected. this may be bug...";default:throw"child type "+w.type+" is invalid.";}$++}},ua=function(e,r,t){if(void 0===t&&(t=!1),0!==e.length)if("else"!==e[0].type){var a,o=r.dx,n=r.dy,i=r.hlineMargin,s=r.branch(),c=r.branch(),l=r.loop.type,h=e[0],p={dir:"S",jump:!1},$={dir:"E",jump:!1};if(h.children.length>0)"break"!==(a=h.children[0].type)&&"continue"!==a||(p={dir:fa[l][a],jump:!0},$={dir:"S",jump:!1});if(e.length>1&&"else"===e[1].type&&e[1].children.length>0)if("break"===(a=e[1].children[0].type)||"continue"===a){var w=fa[l][a];w!==p.dir&&($={dir:w,jump:!0})}var u=r.stepCond({content:h.content,yesDir:p.dir,noDir:$.dir,jumpW:p.jump&&"W"===p.dir||$.jump&&"W"===$.dir,jumpE:p.jump&&"E"===p.dir||$.jump&&"E"===$.dir,stepY:"if"===e[0].type?n:i});if(s.moveAbs(u[p.dir].y),O(h,s,p.jump),s.shiftX(u[p.dir].x),c.moveAbs(u[$.dir].y),ua(e.slice(1),c,$.jump),$.jump||p.jump)c.shiftX(u[$.dir].x);else{var y=Math.max(u.E.x,s.shapes.maxX)+o-c.shapes.minX;c.shiftX(y),s.shapes.add(H.hline({x:u.E.x,y:u.E.y,step:c.shapes.x-u.E.x}));var x=void 0;if(c.alive){var f=r.AllocE.findSpace(Math.max(s.y,c.y),i);r.AllocW.merge(f,i),x=f+i}else x=Math.max(s.y,c.y);s.alive&&s.stepAbs(x),c.alive&&c.stepAbs(x),c.alive&&s.shapes.add(H.hline({x:c.shapes.x,y:x,step:-c.shapes.x+s.shapes.x,isArrow:s.alive}))}r.merge(s),r.merge(c),s.alive||c.alive||(r.alive=!1)}else O(e[0],r,t)},Ea=function(e,r){var t=r.branch(),a=t.moveAbs,o=t.stepAbs,n=t.dx,i=t.dy,s=t.stepCond,c=t.withLoop,l=t.shapes,h=t.AllocW,p=t.AllocE,$=t.hlineMargin,w=p.findSpace(t.y+i-$,$);h.merge(w,$),o(w+$);var u=t.y,y=s({content:e.content,yesDir:"S",noDir:"E",jumpE:!1,jumpW:!1,stepY:$}),x=c("while",function(){O(e,t)}),f=x.breaks,m=x.continues,v=N(m),d=N(f);if(t.alive){w=p.findSpace(t.y,$);h.merge(w,$),o(w+$),v.push(new U({x:0,y:t.y}))}d.push(new U(ra({},y.E)));var T=Math.min(y.W.x,l.minX)-n,D=Math.max(y.E.x,l.maxX)+n;v.sort(function(e,r){return e.y>r.y?-1:1}).forEach(function(e,r){l.add(new H({x:e.x,y:e.y,isArrow:!0,cmds:0===r?[["h",T-e.x],["v",u-e.y],["h",-T]]:[["h",T-e.x]]}))});w=p.findSpace(t.y,$);h.merge(w,$),a(w+$),d.sort(function(e,r){return e.y<r.y?-1:1}).forEach(function(e,r){l.add(new H({x:e.x,y:e.y,isArrow:0!==r,cmds:0===r?[["h",D-e.x],["v",t.y-e.y],["h",-D]]:[["h",D-e.x]]}))}),r.merge(t)},Fa=function(e,r,t){var a=t.branch(),o=a.moveAbs,n=a.stepAbs,i=a.dx,s=a.dy,c=a.stepCond,l=a.shapes,h=a.withLoop,p=a.AllocW,$=a.AllocE,w=a.hlineMargin,u=$.findSpace(a.y+s-w,w);p.merge(u,w),n(u+w);var y,x,f=a.y,m=h("doWhile",function(){O(e,a)}),v=m.breaks,d=m.continues,T=N(v),D=0;if(a.alive||d.length>0){if(d.length>0){u=$.findSpace(a.y,w);p.merge(u,w),a.alive?n(u+w):o(u+w),D=l.maxX+i,d.sort(function(e,r){return e.y<r.y?-1:1}).forEach(function(e,r){l.add(new H({x:e.x,y:e.y,isArrow:!0,cmds:0===r?[["h",D-e.x],["v",a.y-e.y],["h",-D]]:[["h",D-e.x]]}))})}var g=c({content:r.content,yesDir:"S",noDir:"E",jumpW:!1,jumpE:!1});u=$.findSpace(a.y,w);p.merge(u,w),n(u+w),y=Math.min(g.W.x,l.minX)-i,l.add(new H({x:0,y:a.y,isArrow:!0,cmds:[["h",y],["v",f-a.y],["h",-y]]})),x=Math.max(g.E.x,l.maxX,D)+i,T.push(new U(ra({},g.E)))}else{u=$.findSpace(a.y,w);p.merge(u,w),o(u+w),x=l.maxX+i}u=$.findSpace(a.y,w);p.merge(u,w),o(u+w),T.sort(function(e,r){return e.y<r.y?-1:1}).forEach(function(e,r){l.add(new H({x:e.x,y:e.y,isArrow:0!==r,cmds:0===r?[["h",x-e.x],["v",a.y-e.y],["h",-x]]:[["h",x-e.x]]}))}),t.merge(a)},Ga=function(e,r,t){var a,o,n=t.dx,i=(t.dy,t.hlineMargin),s=t.branch(),c=r.map(function(){return t.branch()}),l=s.branch(),h=l.AllocE.findSpace(l.y,i);l.AllocW.merge(h,i);var p=h+i;l.stepAbs(p),O(e,l);var $=s.AllocE.findSpace(p,i);s.AllocW.merge($,i),o=$+i;var w=s.AllocE.findSpace(Math.max(l.y,o),i);s.AllocW.merge(w,i);var u=w+i;l.alive?l.stepAbs(u):l.moveAbs(u),a=l.x+l.shapes.maxX+n;var y=l.x+l.shapes.minX-n;l.shapes.add(new pa({x:y,y:p,w:a-y,h:u-p})),s.merge(l),l.alive||(s.alive=!1),c.forEach(function(e){e.moveAbs(o)});var x=s;if(r.forEach(function(e,r){var t=c[r],a=t.y;O(e,t);var o=x.x+x.shapes.maxX+n-t.shapes.minX;t.shiftX(o),t.shapes.add(t.text({x:t.config.label.marginX,y:a+t.config.label.marginY,text:e.content,isLabel:!0})),x=t}),s.shapes.add(H.hline({x:a,y:o,step:c.slice(-1)[0].shapes.x-a})),c.some(function(e){return e.alive})){var f=N([s],c).map(function(e){return e.y}).reduce(function(e,r){return Math.max(e,r)}),m=t.AllocE.findSpace(f,i);t.AllocW.merge(m,i);var v=m+i;N([s],c).filter(function(e){return e.alive}).forEach(function(e){e.stepAbs(v)});var d=c.filter(function(e){return e.alive}).slice(-1)[0];s.shapes.add(H.hline({x:d.shapes.x,y:v,step:-d.shapes.x+s.shapes.x,isArrow:s.alive}))}else if(s.alive){var T=N([s],c).map(function(e){return e.y}).reduce(function(e,r){return Math.max(e,r)});s.stepAbs(T)}t.merge(s),c.forEach(function(e){return t.merge(e)}),N([s],c).every(function(e){return!e.alive})&&(t.alive=!1)};P.Flowchart=sa,P.createFlowchart=ta;var ca={},q=ca&&ca.__assign||function(){return(q=Object.assign||function($){for(var a,r=1,t=arguments.length;r<t;r++)for(var s in a=arguments[r])Object.prototype.hasOwnProperty.call(a,s)&&($[s]=a[s]);return $}).apply(this,arguments)},da="100%",I="black",ha="white",z={src:{indentStr:"  ",commentStr:"#"},flowchart:{marginX:35,marginY:35,stepX:24,stepY:24,hlineMargin:24,backgroundColor:"white"},rect:{padX:12,padY:8,attrs:{stroke:I,fill:ha,"stroke-width":"2px","fill-opacity":"0%"}},frame:{attrs:{stroke:I,"stroke-dasharray":"2",fill:ha,"stroke-width":"2px","fill-opacity":"0%"}},diamond:{aspectRatio:.75,attrs:{stroke:I,fill:ha,"fill-opacity":"0%","stroke-width":"2px"}},path:{attrs:{stroke:I,fill:"none","stroke-linecap":"square","stroke-width":"2px","fill-opacity":"0%","stroke-opacity":da}},arrowHead:{size:9,attrs:{stroke:I,fill:I,"fill-opacity":da,"stroke-width":"0px"}},text:{attrs:{stroke:I,fill:I,"fill-opacity":da,"font-size":"14px","stroke-width":"0"}},label:{yesText:"Y",noText:"N",marginX:4,marginY:4,attrs:{stroke:I,fill:I,"fill-opacity":da,"font-size":"10px","font-weight":"lighter"}}},va=function($){return void 0===$&&($={}),{src:q(q({},z.src),$.src||{}),flowchart:q(q({},z.flowchart),$.flowchart||{}),rect:q(q(q({},z.rect),$.rect||{}),{attrs:q(q({},z.rect.attrs),$.rect&&$.rect.attrs||{})}),diamond:q(q(q({},z.diamond),$.diamond||{}),{attrs:q(q({},z.diamond.attrs),$.diamond&&$.diamond.attrs||{})}),path:q(q(q({},z.path),$.path||{}),{attrs:q(q({},z.path.attrs),$.path&&$.path.attrs||{})}),arrowHead:q(q(q({},z.arrowHead),$.arrowHead||{}),{attrs:q(q({},z.arrowHead.attrs),$.arrowHead&&$.arrowHead.attrs||{})}),text:q(q(q({},z.text),$.text||{}),{attrs:q(q({},z.text.attrs),$.text&&$.text.attrs||{})}),frame:q(q(q({},z.frame),$.frame||{}),{attrs:q(q({},z.frame.attrs),$.frame&&$.frame.attrs||{})}),label:q(q(q({},z.label),$.label||{}),{attrs:q(q({},z.label.attrs),$.label&&$.label.attrs||{})})}};ca.mergeDefaultConfig=va,ca.defaultConfig=z;var J=Z&&Z.__assign||function(){return(J=Object.assign||function(e){for(var r,a=1,t=arguments.length;a<t;a++)for(var n in r=arguments[a])Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n]);return e}).apply(this,arguments)},wa=function(){return function(e){var r=this,a=e.src,t=e.config,n=e.document;this.el=function(e,a){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var s=r._document.createElementNS("http://www.w3.org/2000/svg",e);return Object.entries(a||{}).forEach(function(e){var r=e[0],a=e[1];return s.setAttribute("className"===r?"class":r,a.toString())}),(t||[]).forEach(function(e){return s.append(e)}),s},this.createTextSVGElement=function(e,a){var t=r.el,n=t("text",a||{});return e.split(/\\n/).forEach(function(e,r){n.append(t("tspan",{x:a.x,dy:(0===r?0:1)+"em"},e))}),n},this.measureText=function(e,a){void 0===a&&(a={});var t=r,n=t.dummySVG,s=t.createTextSVGElement,i=J(J({},a),{x:a.x||0});r._document.body.append(n);var o=s(e,i);n.append(o);var p=o.getBoundingClientRect(),c=p.width,d=p.height;return n.removeChild(o),r._document.body.removeChild(n),{w:c,h:d}},this.renderShape=function(e){var a=e.layers,t=e.shape,n=e.config,s=e.offsetX,i=void 0===s?0:s,o=e.offsetY,p=void 0===o?0:o,c=r,d=c.el,h=c.createTextSVGElement,$=c.renderShape,u=c.measureText,g=i+t.x,l=p+t.y,f=t.w,m=t.h;switch(t.type){case"group":t.children.forEach(function(e){return $({layers:a,config:n,shape:e,offsetX:g,offsetY:l})});break;case"text":a.textLayer.append(h(t.content,J({x:g,y:l+u("A",t.isLabel?n.label.attrs:n.text.attrs).h/2,"dominant-baseline":"central"},t.isLabel?n.label.attrs:n.text.attrs)));break;case"path":var v="M "+g+" "+l,w=t.cmds.map(function(e){return e.join(" ")}).join(" ");a.pathLayer.append(d("path",J(J({d:v+" "+w},t.isArrow?{"marker-end":"url(#arrow-head)"}:{}),n.path.attrs)));break;case"rect":a.nodeLayer.append(d("rect",J({x:g,y:l,width:f,height:m},n.rect.attrs)));break;case"frame":a.frameLayer.append(d("rect",J({x:g,y:l,width:f,height:m},n.frame.attrs)));break;case"diamond":a.nodeLayer.append(d("polygon",J({points:g+f/2+","+l+", "+(g+f)+","+(l+m/2)+" "+(g+f/2)+","+(l+m)+" "+g+","+(l+m/2)},n.diamond.attrs)));break;case"point":break;default:throw"shape "+t+" is invalid";}},this.render=function(){var e=r,a=e.src,t=e.config,n=e.el,s=e.measureText,i=e.renderShape,o=r.el("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg"}),p=n("defs",null,n("marker",{id:"arrow-head",markerUnits:"userSpaceOnUse",markerWidth:""+t.arrowHead.size,markerHeight:""+2*t.arrowHead.size,viewBox:"0 0 10 10",refX:"10",refY:"5",orient:"auto-start-reverse"},n("polygon",J({points:"0,0 0,10 10,5",class:"arrow-head"},t.arrowHead.attrs))));o.append(p);var c=n("g"),d=n("g"),h=n("g"),$=n("g"),u=n("g"),g=ta({node:ma(a,t),config:t,measureText:s});i({layers:{frameLayer:d,pathLayer:h,nodeLayer:$,textLayer:u},shape:g.shapes,config:t}),o.append(c),o.append(d),o.append(h),o.append($),o.append(u),o.setAttribute("width",(g.shapes.w+2*t.flowchart.marginX).toString()),o.setAttribute("height",(g.shapes.h+2*t.flowchart.marginY).toString());var l=t.flowchart.backgroundColor;if(!["","none","transparent"].includes(l)){var f=Number(o.getAttribute("width")),m=Number(o.getAttribute("height"));c.append(n("rect",{x:0,y:0,width:f,height:m,fill:l}))}return o},this._document=n,this.src=a,this.config=t=va(t),this.dummySVG=this.el("svg")}}(),xa=function(e){return new wa(e).render()};Z.Renderer=wa,Z.render=xa;var Ha=Y&&Y.__spreadArrays||function(){for(var r=0,e=0,t=arguments.length;e<t;e++)r+=arguments[e].length;var a=Array(r),c=0;for(e=0;e<t;e++)for(var n=arguments[e],$=0,f=n.length;$<f;$++,c++)a[c]=n[$];return a},Ia={initialize:function(r){Ha(document.getElementsByClassName("tefcha")).forEach(function(e){var t=e.textContent;e.textContent="",e.append(xa({src:t,document:document,config:r}))})}};window.tefcha=Ia;if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=Y}else if(typeof define==="function"&&define.amd){define(function(){return Y})}})();